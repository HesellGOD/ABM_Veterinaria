{% extends "base.html" %}
{% load static %}

{% block title %}Ficha de {{ mascota.nombre }} - VetCare{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="ficha-mascota mx-auto bg-white rounded-4 shadow-lg p-4" style="max-width: 800px;">
    <!-- Encabezado -->
    <div class="text-center mb-4">
      <h1 class="display-6 fw-bold text-primary">Carnet de Mascota</h1>
      <div class="small text-muted">VetCare - Sistema de Gestión Veterinaria</div>
    </div>

    <!-- Datos de la mascota -->
    <div class="datos-mascota mb-4">
      <h5 class="text-secondary mb-3">Datos de la mascota</h5>
      <div class="row g-3">
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Nombre:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.nombre }}</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Especie:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.especie }}</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Raza:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.raza }}</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Fecha de Nacimiento:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.fecha_nacimiento }}</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Edad:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.get_edad }}</div>
          </div>
        </div>
        <div class="col-12">
          <div class="form-group">
            <label class="form-label text-muted small">Observaciones:</label>
            <div class="form-control-plaintext border-bottom">
              Peso: {{ mascota.peso }} kg | Esterilizado: {% if mascota.esterilizado %}Sí{% else %}No{% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Datos del propietario -->
    <div class="datos-propietario mb-4">
      <h5 class="text-secondary mb-3">Datos del/la Propietario/a</h5>
      <div class="row g-3">
        <div class="col-12">
          <div class="form-group">
            <label class="form-label text-muted small">Nombre y Apellido:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.dueño.nombre }}</div>
          </div>
        </div>
        <div class="col-12">
          <div class="form-group">
            <label class="form-label text-muted small">Dirección:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.dueño.direccion }}</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Teléfono:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.dueño.telefono }}</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label class="form-label text-muted small">Email:</label>
            <div class="form-control-plaintext border-bottom">{{ mascota.dueño.email }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabla de vacunación -->
    <div class="tabla-vacunacion mb-4">
      <h5 class="text-secondary mb-3">Registro de visitas</h5>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead class="table-light">
            <tr>
              <th>Peso (Kg)</th>
              <th>Fecha de la visita</th>
              <th>Motivo de la visita</th>
              <th>Firma y sello</th>
            </tr>
          </thead>
          <tbody>
            {% for visita in mascota.visitas.all %}
            <tr>
              <td>{{ visita.peso }}</td>
              <td>{{ visita.fecha }}</td>
              <td>{{ visita.motivo }}</td>
              <td></td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4" class="text-center text-muted">No hay registros de visitas</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- Botones -->
    <div class="d-flex justify-content-between">
      <a href="{% url 'mascota_list' %}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left me-2"></i>Volver
      </a>
      <div>
        <a href="{% url 'mascota_edit' mascota.id %}" class="btn btn-primary me-2">
          <i class="bi bi-pencil me-2"></i>Editar
        </a>
        <a href="{% url 'exportar_pdf' mascota.id %}" class="btn btn-success" target="_blank">
          <i class="bi bi-file-earmark-pdf me-2"></i>Exportar PDF
        </a>
      </div>
    </div>
  </div>
</div>

<style>
.ficha-mascota {
  background-image: url('{% static "img/paw-pattern.png" %}');
  background-size: 200px;
  background-position: right -50px top -50px;
  background-repeat: no-repeat;
  background-blend-mode: soft-light;
}
.form-control-plaintext {
  font-weight: 500;
  padding: 0.375rem 0;
}
.border-bottom {
  border-bottom: 1px solid #dee2e6!important;
}
</style>
{% endblock %}
